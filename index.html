!DOCTYPE html
html lang=ar dir=rtl
head
    meta charset=UTF-8
    meta name=viewport content=width=device-width, initial-scale=1.0
    titleGMB Test - Bulk Density Calculatortitle
    script src=httpscdn.tailwindcss.comscript
    script src=httpscdnjs.cloudflare.comajaxlibsxlsx0.18.5xlsx.full.min.jsscript
    script src=httpscdnjs.cloudflare.comajaxlibsjspdf2.5.1jspdf.umd.min.jsscript
    link href=httpscdnjs.cloudflare.comajaxlibsfont-awesome6.0.0cssall.min.css rel=stylesheet
    script
        tailwind.config = {
            theme {
                extend {
                    colors {
                        brand {
                            primary '#00685E',
                            secondary '#8BAA99',
                            dark '#101820',
                            accent {
                                yellow '#F2C75C',
                                orange '#E59256',
                                red '#A13525',
                                blue '#006797',
                                teal '#00A399',
                                brown '#B98346'
                            }
                        }
                    },
                    fontFamily {
                        'arabic' ['Segoe UI', 'Tahoma', 'Arial', 'sans-serif'],
                    },
                    animation {
                        'fade-in' 'fadeIn 0.5s ease-in-out',
                        'slide-up' 'slideUp 0.6s ease-out',
                        'pulse-slow' 'pulse 3s infinite',
                    },
                    keyframes {
                        fadeIn {
                            '0%' { opacity '0', transform 'translateY(10px)' },
                            '100%' { opacity '1', transform 'translateY(0)' },
                        },
                        slideUp {
                            '0%' { opacity '0', transform 'translateY(30px)' },
                            '100%' { opacity '1', transform 'translateY(0)' },
                        }
                    }
                }
            }
        }
    script
    style
        @media print {
            .no-print { display none !important; }
            .print-landscape { 
                size landscape;
                margin 0.5in;
            }
            table { 
                page-break-inside avoid;
                font-size 11px;
            }
            @page {
                size A4 landscape;
                margin 0.5in;
            }
        }
        
        .rtl { direction rtl; }
        .ltr { direction ltr; }
        
         Custom Gradient Backgrounds 
        .gradient-primary {
            background linear-gradient(135deg, #00685E 0%, #8BAA99 100%);
        }
        
        .gradient-accent {
            background linear-gradient(135deg, #00A399 0%, #006797 100%);
        }
        
        .gradient-warm {
            background linear-gradient(135deg, #F2C75C 0%, #E59256 100%);
        }
        
         Glass morphism effect 
        .glass {
            backdrop-filter blur(16px) saturate(180%);
            background-color rgba(255, 255, 255, 0.75);
            border 1px solid rgba(255, 255, 255, 0.125);
        }
        
        .dark .glass {
            background-color rgba(31, 41, 55, 0.75);
            border 1px solid rgba(75, 85, 99, 0.125);
        }
        
         Custom shadows 
        .shadow-brand {
            box-shadow 0 10px 25px -3px rgba(0, 104, 94, 0.1), 0 4px 6px -2px rgba(0, 104, 94, 0.05);
        }
        
        .shadow-accent {
            box-shadow 0 10px 25px -3px rgba(0, 163, 153, 0.1), 0 4px 6px -2px rgba(0, 163, 153, 0.05);
        }
        
         Enhanced input styling 
        .input-enhanced {
            transition all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border 2px solid transparent;
        }
        
        .input-enhancedfocus {
            border-color #00685E;
            box-shadow 0 0 0 3px rgba(0, 104, 94, 0.1);
            transform translateY(-1px);
        }
        
         Custom button styles 
        .btn-primary {
            background linear-gradient(135deg, #00685E 0%, #8BAA99 100%);
            transition all 0.3s ease;
        }
        
        .btn-primaryhover {
            transform translateY(-2px);
            box-shadow 0 8px 25px -8px rgba(0, 104, 94, 0.5);
        }
        
        .btn-secondary {
            background linear-gradient(135deg, #00A399 0%, #006797 100%);
            transition all 0.3s ease;
        }
        
        .btn-secondaryhover {
            transform translateY(-2px);
            box-shadow 0 8px 25px -8px rgba(0, 163, 153, 0.5);
        }
        
         Table enhancements 
        .table-enhanced {
            background rgba(255, 255, 255, 0.95);
            backdrop-filter blur(10px);
        }
        
        .dark .table-enhanced {
            background rgba(31, 41, 55, 0.95);
        }
        
         Logo styling 
        .logo-container {
            background linear-gradient(135deg, #00685E 0%, #8BAA99 50%, #00A399 100%);
            -webkit-background-clip text;
            -webkit-text-fill-color transparent;
            background-clip text;
        }
        
         Green color for numbers in results table 
        .number-cell { 
            color #00A399; 
            font-weight 600;
            font-family 'Courier New', monospace;
        }
        .dark .number-cell { 
            color #22c55e; 
        }
        
         Enhanced status styling 
        .status-passed {
            background linear-gradient(135deg, #10b981 0%, #059669 100%);
            color white;
            padding 4px 12px;
            border-radius 20px;
            font-size 12px;
            font-weight 600;
            text-shadow 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
        .status-failed {
            background linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            color white;
            padding 4px 12px;
            border-radius 20px;
            font-size 12px;
            font-weight 600;
            text-shadow 0 1px 2px rgba(0, 0, 0, 0.1);
        }
        
         Dark mode support 
        .dark .bg-white { background-color #1f2937; }
        .dark .text-gray-900 { color #f9fafb; }
        .dark .text-gray-700 { color #d1d5db; }
        .dark .text-gray-600 { color #9ca3af; }
        .dark .border-gray-300 { border-color #4b5563; }
        .dark .bg-gray-50 { background-color #111827; }
        
         Loading animation 
        .loading-pulse {
            animation pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
         Card hover effects 
        .card-hover {
            transition all 0.3s ease;
        }
        
        .card-hoverhover {
            transform translateY(-5px);
            box-shadow 0 20px 40px -12px rgba(0, 104, 94, 0.15);
        }
    style
head
body class=bg-gradient-to-br from-gray-50 via-blue-50 to-teal-50 darkfrom-gray-900 darkvia-gray-800 darkto-gray-900 min-h-screen font-arabic
    !-- Decorative Background Elements --
    div class=fixed inset-0 overflow-hidden pointer-events-none
        div class=absolute -top-40 -right-40 w-80 h-80 rounded-full bg-brand-primary opacity-5 animate-pulse-slowdiv
        div class=absolute -bottom-40 -left-40 w-96 h-96 rounded-full bg-brand-accent-teal opacity-5 animate-pulse-slowdiv
        div class=absolute top-12 left-12 transform -translate-x-12 -translate-y-12 w-64 h-64 rounded-full bg-brand-accent-yellow opacity-3 animate-pulse-slowdiv
    div

    div class=container mx-auto px-4 py-6 max-w-7xl relative z-10
        !-- Enhanced Header --
        div class=gradient-primary text-white p-8 rounded-2xl shadow-brand mb-8 animate-slide-up card-hover
            div class=flex justify-between items-center flex-wrap gap-4
                div class=flex items-center gap-4
                    div class=w-16 h-16 bg-white bg-opacity-20 rounded-xl flex items-center justify-center backdrop-blur-sm
                        i class=fas fa-vials text-2xl text-whitei
                    div
                    div
                        h1 class=text-3xl mdtext-4xl font-bold mb-2 id=mainTitleاختبار الكثافة الظاهرية للإسفلتh1
                        p class=text-white text-opacity-90 text-lg id=subtitleGMB Test - Bulk Density Calculatorp
                        div class=flex items-center gap-2 mt-2 text-sm text-white text-opacity-80
                            i class=fas fa-certificatei
                            spanProfessional Laboratory Testing Systemspan
                        div
                    div
                div
                button onclick=toggleLanguage() class=btn-secondary text-white px-6 py-3 rounded-xl font-semibold flex items-center gap-2 shadow-accent
                    i class=fas fa-languagei
                    span id=langBtnEnglishspan
                button
            div
        div

        !-- Enhanced Project Information --
        div class=glass p-8 rounded-2xl shadow-brand mb-8 animate-fade-in card-hover
            div class=flex items-center gap-3 mb-6
                div class=w-10 h-10 gradient-accent rounded-lg flex items-center justify-center
                    i class=fas fa-project-diagram text-whitei
                div
                h2 class=text-2xl font-bold text-brand-dark darktext-white id=projectInfoTitleمعلومات المشروعh2
            div
            
            div class=grid grid-cols-1 mdgrid-cols-2 lggrid-cols-4 gap-6
                div class=space-y-2
                    label for=projectName class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=projectNameLabelاسم المشروعlabel
                    div class=relative
                        i class=fas fa-building absolute left-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60i
                        input type=text id=projectName class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=contractorName class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=contractorNameLabelاسم المقاولlabel
                    div class=relative
                        i class=fas fa-user-tie absolute left-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60i
                        input type=text id=contractorName class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=layerType class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=layerTypeLabelنوع الطبقةlabel
                    div class=relative
                        i class=fas fa-layer-group absolute left-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60i
                        select id=layerType class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white appearance-none
                            option value=اختر نوع الطبقةoption
                            option value=B.W.CB.W.Coption
                            option value=B.B.CB.B.Coption
                        select
                        i class=fas fa-chevron-down absolute right-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60 pointer-events-nonei
                    div
                div
                div class=space-y-2
                    label for=testDate class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=testDateLabelتاريخ الاختبارlabel
                    div class=relative
                        i class=fas fa-calendar-alt absolute left-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60i
                        input type=date id=testDate class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
            div
            
            div class=grid grid-cols-1 mdgrid-cols-2 gap-6 mt-6
                div class=space-y-2
                    label for=minCompaction class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=minCompactionLabelالحد الأدنى لنسبة الدمك (%)label
                    div class=relative
                        i class=fas fa-arrow-down absolute left-3 top-12 transform -translate-y-12 text-brand-accent-red text-opacity-60i
                        input type=number id=minCompaction step=0.1 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=maxCompaction class=block text-sm font-semibold text-brand-dark darktext-gray-300 mb-3 id=maxCompactionLabelالحد الأعلى لنسبة الدمك (%)label
                    div class=relative
                        i class=fas fa-arrow-up absolute left-3 top-12 transform -translate-y-12 text-green-500 text-opacity-60i
                        input type=number id=maxCompaction step=0.1 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
            div
        div

        !-- Enhanced Sample Input --
        div class=glass p-8 rounded-2xl shadow-brand mb-8 animate-fade-in card-hover
            div class=flex items-center gap-3 mb-6
                div class=w-10 h-10 gradient-warm rounded-lg flex items-center justify-center
                    i class=fas fa-flask text-whitei
                div
                h2 class=text-2xl font-bold text-brand-dark darktext-white id=sampleInputTitleإدخال بيانات العينةh2
                div class=flex-1div
                div class=text-sm text-gray-600 darktext-gray-400 bg-gray-100 darkbg-gray-700 px-3 py-1 rounded-full
                    span id=sampleCountالعينات 050span
                div
            div
            
            div class=grid grid-cols-1 mdgrid-cols-2 lggrid-cols-3 xlgrid-cols-6 gap-4
                div class=space-y-2
                    label for=sampleName class=block text-sm font-semibold text-brand-dark darktext-gray-300 id=sampleNameLabelاسم العينةlabel
                    div class=relative
                        i class=fas fa-tag absolute left-3 top-12 transform -translate-y-12 text-brand-primary text-opacity-60i
                        input type=text id=sampleName class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=weightInAir class=block text-sm font-semibold text-brand-dark darktext-gray-300 id=weightInAirLabelالوزن في الهواء (g)label
                    div class=relative
                        i class=fas fa-weight-hanging absolute left-3 top-12 transform -translate-y-12 text-brand-accent-blue text-opacity-60i
                        input type=number id=weightInAir step=0.01 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=weightInWater class=block text-sm font-semibold text-brand-dark darktext-gray-300 id=weightInWaterLabelالوزن في الماء (g)label
                    div class=relative
                        i class=fas fa-tint absolute left-3 top-12 transform -translate-y-12 text-brand-accent-teal text-opacity-60i
                        input type=number id=weightInWater step=0.01 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=saturatedWeight class=block text-sm font-semibold text-brand-dark darktext-gray-300 id=saturatedWeightLabelالوزن مشبع السطح (g)label
                    div class=relative
                        i class=fas fa-droplet absolute left-3 top-12 transform -translate-y-12 text-brand-accent-teal text-opacity-60i
                        input type=number id=saturatedWeight step=0.01 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=space-y-2
                    label for=gmmValue class=block text-sm font-semibold text-brand-dark darktext-gray-300 id=gmmValueLabelقيمة GMMlabel
                    div class=relative
                        i class=fas fa-calculator absolute left-3 top-12 transform -translate-y-12 text-brand-accent-brown text-opacity-60i
                        input type=number id=gmmValue step=0.001 class=w-full pl-10 pr-4 py-3 text-base border-2 border-gray-200 rounded-xl input-enhanced focusring-2 focusring-brand-primary focusborder-transparent darkbg-gray-700 darkborder-gray-600 darktext-white
                    div
                div
                div class=flex items-end
                    button onclick=addSample() class=w-full btn-primary text-white px-6 py-3 rounded-xl font-semibold shadow-brand flex items-center justify-center gap-2 id=addSampleBtn
                        i class=fas fa-plusi
                        spanإضافة العينةspan
                    button
                div
            div
        div

        !-- Enhanced Results Table --
        div class=glass p-8 rounded-2xl shadow-brand mb-8 animate-fade-in card-hover id=resultsSection style=display none;
            div class=flex justify-between items-center mb-6 flex-wrap gap-4
                div class=flex items-center gap-3
                    div class=w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center
                        i class=fas fa-chart-line text-whitei
                    div
                    h2 class=text-2xl font-bold text-brand-dark darktext-white id=resultsTitleالنتائجh2
                div
                div class=flex gap-3 no-print flex-wrap
                    button onclick=clearAll() class=bg-brand-accent-red hoverbg-red-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 shadow-lg transition-all hovertransform hover-translate-y-1 id=clearBtn
                        i class=fas fa-trashi
                        spanمسح الكلspan
                    button
                    button onclick=printResults() class=bg-brand-accent-blue hoverbg-blue-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 shadow-lg transition-all hovertransform hover-translate-y-1 id=printBtn
                        i class=fas fa-printi
                        spanطباعةspan
                    button
                    button onclick=exportToExcel() class=bg-brand-accent-teal hoverbg-teal-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 shadow-lg transition-all hovertransform hover-translate-y-1 id=excelBtn
                        i class=fas fa-file-exceli
                        spanتصدير Excelspan
                    button
                    button onclick=exportToPDF() class=bg-brand-accent-orange hoverbg-orange-600 text-white px-4 py-2 rounded-lg font-semibold flex items-center gap-2 shadow-lg transition-all hovertransform hover-translate-y-1 id=pdfBtn
                        i class=fas fa-file-pdfi
                        spanتصدير PDFspan
                    button
                div
            div
            
            div class=overflow-x-auto rounded-xl
                table class=w-full border-collapse text-sm table-enhanced shadow-lg rounded-xl overflow-hidden id=resultsTable
                    thead
                        tr class=gradient-primary text-white
                            th class=px-4 py-4 text-left font-semibold id=thSampleName
                                div class=flex items-center gap-2
                                    i class=fas fa-tagi
                                    اسم العينة
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thWeightInAir
                                div class=flex items-center gap-2
                                    i class=fas fa-weight-hangingi
                                    الوزن في الهواء (g)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thWeightInWater
                                div class=flex items-center gap-2
                                    i class=fas fa-tinti
                                    الوزن في الماء (g)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thSaturatedWeight
                                div class=flex items-center gap-2
                                    i class=fas fa-dropleti
                                    الوزن مشبع السطح (g)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thVolume
                                div class=flex items-center gap-2
                                    i class=fas fa-cubei
                                    الحجم (cm³)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thDensity
                                div class=flex items-center gap-2
                                    i class=fas fa-compressi
                                    الكثافة (gcm³)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thGmm
                                div class=flex items-center gap-2
                                    i class=fas fa-calculatori
                                    GMM
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thCompaction
                                div class=flex items-center gap-2
                                    i class=fas fa-percentagei
                                    نسبة الدمك (%)
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold id=thStatus
                                div class=flex items-center gap-2
                                    i class=fas fa-check-circlei
                                    الحالة
                                div
                            th
                            th class=px-4 py-4 text-left font-semibold no-print id=thActions
                                div class=flex items-center gap-2
                                    i class=fas fa-cogsi
                                    الإجراءات
                                div
                            th
                        tr
                    thead
                    tbody id=tableBody
                    tbody
                table
            div
        div
    div

    script
        let currentLanguage = 'ar';
        let samples = [];
        
         Dark mode detection
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme dark)').addEventListener('change', event = {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

         Language translations
        const translations = {
            ar {
                mainTitle 'اختبار الكثافة الظاهرية للإسفلت',
                subtitle 'GMB Test - Bulk Density Calculator',
                langBtn 'English',
                projectInfoTitle 'معلومات المشروع',
                projectNameLabel 'اسم المشروع',
                contractorNameLabel 'اسم المقاول',
                layerTypeLabel 'نوع الطبقة',
                testDateLabel 'تاريخ الاختبار',
                minCompactionLabel 'الحد الأدنى لنسبة الدمك (%)',
                maxCompactionLabel 'الحد الأعلى لنسبة الدمك (%)',
                sampleInputTitle 'إدخال بيانات العينة',
                sampleNameLabel 'اسم العينة',
                weightInAirLabel 'الوزن في الهواء (g)',
                weightInWaterLabel 'الوزن في الماء (g)',
                saturatedWeightLabel 'الوزن مشبع السطح (g)',
                gmmValueLabel 'قيمة GMM',
                addSampleBtn 'إضافة العينة',
                resultsTitle 'النتائج',
                clearBtn 'مسح الكل',
                printBtn 'طباعة',
                excelBtn 'تصدير Excel',
                pdfBtn 'تصدير PDF',
                thSampleName 'اسم العينة',
                thWeightInAir 'الوزن في الهواء (g)',
                thWeightInWater 'الوزن في الماء (g)',
                thSaturatedWeight 'الوزن مشبع السطح (g)',
                thVolume 'الحجم (cm³)',
                thDensity 'الكثافة (gcm³)',
                thGmm 'GMM',
                thCompaction 'نسبة الدمك (%)',
                thStatus 'الحالة',
                thActions 'الإجراءات',
                passed 'مقبول',
                failed 'مرفوض',
                delete 'حذف',
                selectLayer 'اختر نوع الطبقة',
                sampleCount 'العينات'
            },
            en {
                mainTitle 'Asphalt Bulk Density Test',
                subtitle 'GMB Test - Bulk Density Calculator',
                langBtn 'العربية',
                projectInfoTitle 'Project Information',
                projectNameLabel 'Project Name',
                contractorNameLabel 'Contractor Name',
                layerTypeLabel 'Layer Type',
                testDateLabel 'Test Date',
                minCompactionLabel 'Minimum Compaction (%)',
                maxCompactionLabel 'Maximum Compaction (%)',
                sampleInputTitle 'Sample Data Input',
                sampleNameLabel 'Sample Name',
                weightInAirLabel 'Weight in Air (g)',
                weightInWaterLabel 'Weight in Water (g)',
                saturatedWeightLabel 'Saturated Surface Weight (g)',
                gmmValueLabel 'GMM Value',
                addSampleBtn 'Add Sample',
                resultsTitle 'Results',
                clearBtn 'Clear All',
                printBtn 'Print',
                excelBtn 'Export Excel',
                pdfBtn 'Export PDF',
                thSampleName 'Sample Name',
                thWeightInAir 'Weight in Air (g)',
                thWeightInWater 'Weight in Water (g)',
                thSaturatedWeight 'Saturated Surface Weight (g)',
                thVolume 'Volume (cm³)',
                thDensity 'Density (gcm³)',
                thGmm 'GMM',
                thCompaction 'Compaction (%)',
                thStatus 'Status',
                thActions 'Actions',
                passed 'Passed',
                failed 'Failed',
                delete 'Delete',
                selectLayer 'Select Layer Type',
                sampleCount 'Samples'
            }
        };

        function toggleLanguage() {
            currentLanguage = currentLanguage === 'ar'  'en'  'ar';
            updateLanguage();
        }

        function updateLanguage() {
            const isArabic = currentLanguage === 'ar';
            document.documentElement.setAttribute('lang', currentLanguage);
            document.documentElement.setAttribute('dir', isArabic  'rtl'  'ltr');
            
             Update all text elements
            Object.keys(translations[currentLanguage]).forEach(key = {
                const element = document.getElementById(key);
                if (element) {
                    if (key === 'sampleCount') {
                        updateSampleCount();
                    } else {
                        element.textContent = translations[currentLanguage][key];
                    }
                }
            });

             Update select options
            const layerSelect = document.getElementById('layerType');
            layerSelect.innerHTML = `
                option value=${translations[currentLanguage].selectLayer}option
                option value=B.W.CB.W.Coption
                option value=B.B.CB.B.Coption
            `;

             Update table headers with icons
            updateTableHeaders();
             Update table if exists
            updateTable();
        }

        function updateTableHeaders() {
            const headers = {
                thSampleName { icon 'fas fa-tag', text translations[currentLanguage].thSampleName },
                thWeightInAir { icon 'fas fa-weight-hanging', text translations[currentLanguage].thWeightInAir },
                thWeightInWater { icon 'fas fa-tint', text translations[currentLanguage].thWeightInWater },
                thSaturatedWeight { icon 'fas fa-droplet', text translations[currentLanguage].thSaturatedWeight },
                thVolume { icon 'fas fa-cube', text translations[currentLanguage].thVolume },
                thDensity { icon 'fas fa-compress', text translations[currentLanguage].thDensity },
                thGmm { icon 'fas fa-calculator', text translations[currentLanguage].thGmm },
                thCompaction { icon 'fas fa-percentage', text translations[currentLanguage].thCompaction },
                thStatus { icon 'fas fa-check-circle', text translations[currentLanguage].thStatus },
                thActions { icon 'fas fa-cogs', text translations[currentLanguage].thActions }
            };

            Object.keys(headers).forEach(id = {
                const element = document.getElementById(id);
                if (element) {
                    element.innerHTML = `
                        div class=flex items-center gap-2
                            i class=${headers[id].icon}i
                            ${headers[id].text}
                        div
                    `;
                }
            });
        }

        function updateSampleCount() {
            const countElement = document.getElementById('sampleCount');
            if (countElement) {
                countElement.textContent = `${translations[currentLanguage].sampleCount} ${samples.length}50`;
            }
        }

        function addSample() {
            const sampleName = document.getElementById('sampleName').value.trim();
            const weightInAir = parseFloat(document.getElementById('weightInAir').value);
            const weightInWater = parseFloat(document.getElementById('weightInWater').value);
            const saturatedWeight = parseFloat(document.getElementById('saturatedWeight').value);
            const gmmValue = parseFloat(document.getElementById('gmmValue').value);

             Validation
            if (!sampleName) {
                showCustomAlert(currentLanguage === 'ar'  'يرجى إدخال اسم العينة'  'Please enter sample name');
                return;
            }

            if (isNaN(weightInAir)  isNaN(weightInWater)  isNaN(saturatedWeight)  isNaN(gmmValue)) {
                showCustomAlert(currentLanguage === 'ar'  'يرجى إدخال جميع القيم المطلوبة'  'Please enter all required values');
                return;
            }

            if (samples.length = 50) {
                showCustomAlert(currentLanguage === 'ar'  'لا يمكن إضافة أكثر من 50 عينة'  'Cannot add more than 50 samples');
                return;
            }

             Calculations
            const volume = saturatedWeight - weightInWater;
            const density = weightInAir  volume;
            const compactionPercentage = (density  gmmValue)  100;

            const sample = {
                id Date.now(),
                name sampleName,
                weightInAir,
                weightInWater,
                saturatedWeight,
                volume volume.toFixed(2),
                density density.toFixed(3),
                gmm gmmValue,
                compaction compactionPercentage.toFixed(2)
            };

            samples.push(sample);
            updateTable();
            updateSampleCount();
            clearInputs();
            
            document.getElementById('resultsSection').style.display = 'block';
            
             Add animation
            const resultsSection = document.getElementById('resultsSection');
            resultsSection.classList.add('animate-slide-up');
        }

        function updateTable() {
            const tbody = document.getElementById('tableBody');
            const minCompaction = parseFloat(document.getElementById('minCompaction').value)  0;
            const maxCompaction = parseFloat(document.getElementById('maxCompaction').value)  100;

            tbody.innerHTML = samples.map((sample, index) = {
                const compaction = parseFloat(sample.compaction);
                const status = (compaction = minCompaction && compaction = maxCompaction) 
                     translations[currentLanguage].passed 
                     translations[currentLanguage].failed;
                const statusClass = (compaction = minCompaction && compaction = maxCompaction) 
                     'status-passed' 
                     'status-failed';

                const bgClass = index % 2 === 0  'bg-white darkbg-gray-800'  'bg-gray-50 darkbg-gray-700';

                return `
                    tr class=hoverbg-brand-primary hoverbg-opacity-5 transition-all duration-200 ${bgClass}
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 font-medium text-brand-dark darktext-white${sample.name}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.weightInAir}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.weightInWater}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.saturatedWeight}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.volume}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.density}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.gmm}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 number-cell${sample.compaction}td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600
                            span class=${statusClass}${status}span
                        td
                        td class=px-4 py-4 border-b border-gray-200 darkborder-gray-600 no-print
                            button onclick=deleteSample(${sample.id}) class=bg-red-500 hoverbg-red-600 text-white px-3 py-1 rounded-lg text-xs font-semibold flex items-center gap-1 transition-all hovertransform hover-translate-y-1
                                i class=fas fa-trashi
                                ${translations[currentLanguage].delete}
                            button
                        td
                    tr
                `;
            }).join('');
        }

        function deleteSample(id) {
            samples = samples.filter(sample = sample.id !== id);
            updateTable();
            updateSampleCount();
            if (samples.length === 0) {
                document.getElementById('resultsSection').style.display = 'none';
            }
        }

        function clearInputs() {
            document.getElementById('sampleName').value = '';
            document.getElementById('weightInAir').value = '';
            document.getElementById('weightInWater').value = '';
            document.getElementById('saturatedWeight').value = '';
            document.getElementById('gmmValue').value = '';
        }

        function clearAll() {
            showConfirmDialog(
                currentLanguage === 'ar'  'هل أنت متأكد من حذف جميع العينات؟'  'Are you sure you want to delete all samples',
                () = {
                    samples = [];
                    updateTable();
                    updateSampleCount();
                    document.getElementById('resultsSection').style.display = 'none';
                }
            );
        }

        function printResults() {
            window.print();
        }

        function exportToExcel() {
            if (samples.length === 0) {
                showCustomAlert(currentLanguage === 'ar'  'لا توجد عينات للتصدير'  'No samples to export');
                return;
            }

            const projectInfo = {
                projectName document.getElementById('projectName').value  'NA',
                contractorName document.getElementById('contractorName').value  'NA',
                layerType document.getElementById('layerType').value  'NA',
                testDate document.getElementById('testDate').value  'NA',
                minCompaction document.getElementById('minCompaction').value  'NA',
                maxCompaction document.getElementById('maxCompaction').value  'NA'
            };

            const minCompaction = parseFloat(document.getElementById('minCompaction').value)  0;
            const maxCompaction = parseFloat(document.getElementById('maxCompaction').value)  100;

            const data = [
                ['GMB Test Results - Bulk Density Calculator'],
                ['Generated on ' + new Date().toLocaleDateString()],
                [''],
                ['Project Information'],
                ['Project Name', projectInfo.projectName],
                ['Contractor Name', projectInfo.contractorName],
                ['Layer Type', projectInfo.layerType],
                ['Test Date', projectInfo.testDate],
                ['Min Compaction (%)', projectInfo.minCompaction],
                ['Max Compaction (%)', projectInfo.maxCompaction],
                [''],
                ['Sample Results'],
                ['Sample Name', 'Weight in Air (g)', 'Weight in Water (g)', 'Saturated Surface Weight (g)', 'Volume (cm³)', 'Density (gcm³)', 'GMM', 'Compaction (%)', 'Status'],
                ...samples.map(sample = {
                    const compaction = parseFloat(sample.compaction);
                    const status = (compaction = minCompaction && compaction = maxCompaction)  'Passed'  'Failed';
                    return [
                        sample.name,
                        sample.weightInAir,
                        sample.weightInWater,
                        sample.saturatedWeight,
                        sample.volume,
                        sample.density,
                        sample.gmm,
                        sample.compaction,
                        status
                    ];
                })
            ];

            const ws = XLSX.utils.aoa_to_sheet(data);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'GMB Test Results');
            XLSX.writeFile(wb, 'GMB_Test_Results.xlsx');
        }

        function exportToPDF() {
            if (samples.length === 0) {
                showCustomAlert(currentLanguage === 'ar'  'لا توجد عينات للتصدير'  'No samples to export');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF('landscape', 'mm', 'a4');
            
             Define colors
            const primaryColor = [0, 104, 94];
            const secondaryColor = [139, 170, 153];
            const accentColor = [0, 163, 153];
            const textColor = [16, 24, 32];
            const successColor = [16, 185, 129];
            const errorColor = [239, 68, 68];

            const projectInfo = {
                projectName document.getElementById('projectName').value  'NA',
                contractorName document.getElementById('contractorName').value  'NA',
                layerType document.getElementById('layerType').value  'NA',
                testDate document.getElementById('testDate').value  'NA',
                minCompaction document.getElementById('minCompaction').value  'NA',
                maxCompaction document.getElementById('maxCompaction').value  'NA'
            };

            const minCompaction = parseFloat(document.getElementById('minCompaction').value)  0;
            const maxCompaction = parseFloat(document.getElementById('maxCompaction').value)  100;

             Header with logo area
            doc.setFillColor(...primaryColor);
            doc.rect(0, 0, 297, 40, 'F');
            
             Title
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(24);
            doc.setFont(undefined, 'bold');
            doc.text('GMB Test - Bulk Density Results', 148, 20, { align 'center' });
            
            doc.setFontSize(12);
            doc.setFont(undefined, 'normal');
            doc.text('Professional Laboratory Testing System', 148, 30, { align 'center' });

             Project Information Section
            doc.setTextColor(...textColor);
            doc.setFillColor(...secondaryColor);
            doc.rect(20, 50, 257, 8, 'F');
            
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 255, 255);
            doc.text('Project Information', 25, 56);

            let yPos = 70;
            doc.setTextColor(...textColor);
            doc.setFontSize(11);
            doc.setFont(undefined, 'normal');
            
            const projectData = [
                ['Project Name', projectInfo.projectName],
                ['Contractor Name', projectInfo.contractorName],
                ['Layer Type', projectInfo.layerType],
                ['Test Date', projectInfo.testDate],
                ['Compaction Range', `${projectInfo.minCompaction}% - ${projectInfo.maxCompaction}%`],
                ['Generated on', new Date().toLocaleDateString() + ' ' + new Date().toLocaleTimeString()]
            ];

            projectData.forEach((item, index) = {
                const x1 = 25 + (index % 2)  125;
                const y = yPos + Math.floor(index  2)  8;
                
                doc.setFont(undefined, 'bold');
                doc.text(item[0], x1, y);
                doc.setFont(undefined, 'normal');
                doc.text(item[1], x1 + 40, y);
            });

             Results Table
            yPos += 40;
            doc.setFillColor(...accentColor);
            doc.rect(20, yPos, 257, 10, 'F');
            
            doc.setFontSize(14);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 255, 255);
            doc.text('Test Results', 25, yPos + 7);

             Table headers
            yPos += 15;
            doc.setFillColor(...primaryColor);
            doc.setFontSize(9);
            doc.setFont(undefined, 'bold');
            doc.setTextColor(255, 255, 255);
            
            const headers = ['Sample', 'Air (g)', 'Water (g)', 'Saturated (g)', 'Volume (cm³)', 'Density (gcm³)', 'GMM', 'Compaction (%)', 'Status'];
            const colWidths = [28, 24, 24, 28, 28, 28, 24, 28, 24];
            let xPos = 20;

             Draw header background and text
            doc.rect(20, yPos, 257, 8, 'F');
            headers.forEach((header, index) = {
                doc.text(header, xPos + 2, yPos + 5.5);
                xPos += colWidths[index];
            });

             Draw data rows
            yPos += 8;
            doc.setFont(undefined, 'normal');
            doc.setFontSize(9);
            
            samples.forEach((sample, index) = {
                const compaction = parseFloat(sample.compaction);
                const status = (compaction = minCompaction && compaction = maxCompaction)  'Passed'  'Failed';
                
                 Alternate row colors
                if (index % 2 === 0) {
                    doc.setFillColor(248, 250, 252);
                    doc.rect(20, yPos, 257, 8, 'F');
                }
                
                xPos = 20;
                const rowData = [
                    sample.name,
                    sample.weightInAir.toString(),
                    sample.weightInWater.toString(),
                    sample.saturatedWeight.toString(),
                    sample.volume,
                    sample.density,
                    sample.gmm.toString(),
                    sample.compaction,
                    status
                ];

                rowData.forEach((data, colIndex) = {
                     Set color for numbers
                    if (colIndex = 1 && colIndex = 7) {
                        doc.setTextColor(...accentColor);
                        doc.setFont(undefined, 'bold');
                    } else if (colIndex === 8) {
                         Status color
                        if (status === 'Passed') {
                            doc.setTextColor(...successColor);
                        } else {
                            doc.setTextColor(...errorColor);
                        }
                        doc.setFont(undefined, 'bold');
                    } else {
                        doc.setTextColor(...textColor);
                        doc.setFont(undefined, 'normal');
                    }
                    
                    const text = data.length  12  data.substring(0, 10) + '..'  data;
                    doc.text(text, xPos + 2, yPos + 5.5);
                    xPos += colWidths[colIndex];
                });
                
                yPos += 8;

                 Check if we need a new page
                if (yPos  190) {
                    doc.addPage();
                    yPos = 20;
                }
            });

             Footer
            const pageCount = doc.internal.getNumberOfPages();
            for (let i = 1; i = pageCount; i++) {
                doc.setPage(i);
                doc.setFillColor(...primaryColor);
                doc.rect(0, 200, 297, 10, 'F');
                
                doc.setTextColor(255, 255, 255);
                doc.setFontSize(8);
                doc.setFont(undefined, 'normal');
                doc.text(`Page ${i} of ${pageCount}`, 280, 206);
                doc.text('GMB Test Report - Generated by Professional Testing System', 20, 206);
            }

            doc.save('GMB_Test_Results.pdf');
        }

        function showCustomAlert(message) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                div class=glass p-8 rounded-2xl shadow-brand max-w-md w-full mx-4 animate-slide-up
                    div class=flex items-center gap-4 mb-4
                        div class=w-12 h-12 bg-brand-accent-orange rounded-full flex items-center justify-center
                            i class=fas fa-exclamation-triangle text-white text-xli
                        div
                        h3 class=text-lg font-bold text-brand-dark darktext-white
                            ${currentLanguage === 'ar'  'تنبيه'  'Alert'}
                        h3
                    div
                    p class=text-gray-700 darktext-gray-300 mb-6${message}p
                    div class=flex justify-end
                        button class=btn-primary text-white px-6 py-3 rounded-xl font-semibold shadow-brand onclick=this.closest('.fixed').remove()
                            ${currentLanguage === 'ar'  'موافق'  'OK'}
                        button
                    div
                div
            `;
            document.body.appendChild(modal);
        }

        function showConfirmDialog(message, onConfirm) {
            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in';
            modal.innerHTML = `
                div class=glass p-8 rounded-2xl shadow-brand max-w-md w-full mx-4 animate-slide-up
                    div class=flex items-center gap-4 mb-4
                        div class=w-12 h-12 bg-brand-accent-red rounded-full flex items-center justify-center
                            i class=fas fa-question-circle text-white text-xli
                        div
                        h3 class=text-lg font-bold text-brand-dark darktext-white
                            ${currentLanguage === 'ar'  'تأكيد'  'Confirm'}
                        h3
                    div
                    p class=text-gray-700 darktext-gray-300 mb-6${message}p
                    div class=flex justify-end space-x-3 gap-3
                        button class=px-6 py-3 text-gray-600 darktext-gray-400 hoverbg-gray-100 darkhoverbg-gray-700 rounded-xl font-semibold transition-all onclick=this.closest('.fixed').remove()
                            ${currentLanguage === 'ar'  'إلغاء'  'Cancel'}
                        button
                        button class=bg-brand-accent-red text-white px-6 py-3 rounded-xl font-semibold shadow-lg hovertransform hover-translate-y-1 transition-all onclick=this.closest('.fixed').remove(); onConfirm()
                            ${currentLanguage === 'ar'  'تأكيد'  'Confirm'}
                        button
                    div
                div
            `;
            document.body.appendChild(modal);
        }

         Set current date as default
        document.getElementById('testDate').valueAsDate = new Date();
        
         Initialize language
        updateLanguage();
        updateSampleCount();
    script
body
html
